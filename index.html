<!DOCTYPE html>
<html>
<head>
    <title>My Practical Exam Codes</title>
    <style>
        body {
            font-family: monospace;
            background-color: #f4f4f4;
            padding: 20px;
        }
        h1 {
            color: #333;
        }
        pre {
            background-color: #fff;
            border: 1px solid #ccc;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>IPC server</h1>
    <pre>
includestdio.h
includeunistd.h
includestdlib.h
includestring.h
includesys/types.h
includesys/msg.h
includesys/ipc.h
int main()
{
struct msgbuf{
	long mtype;
	char mtext[100];
	}send,rcv;
int qid,len;
qid=msgget((key_t)25,IPC_CREAT|0666);
if(qid<0){
	perror("msgget failed");
	exit(1);
}
printf("\nEnter message for TTY-2::");
scanf("%[^\n]s",send.mtext);
send.mtype=1;
len=strlen(send.mtext);
if(msgsnd(qid,&send,len,0)==-1){
	perror("msgsnd failed");
	exit(1);
	
}
if(msgrcv(qid,&rcv,100,2,0)==-1){
	perror("message failed");
	exit(0);
}
printf("\n Message from TTY-2 is %s \n",rcv.mtext);
msgctl(qid, IPC_RMID, NULL);
}
    </pre>

    <h1>IPC client</h1>
    <pre>
includestdio.h
includeunistd.h
includestdlib.h
includestring.h
includesys/types.h
includesys/msg.h
includesys/ipc.h
int main(){
struct msgbuf{
	long mtype;
	char mtext[100];
	}send,rcv;
int qid,len;
qid=msgget((key_t)25,IPC_CREAT|0666);
if(qid<0){
	perror("msgget failed");
	exit(1);
}
if(msgrcv(qid,&rcv,100,1,0)==-1){
	perror("Messae send failed");
	exit(1);
}
printf("message from TTY-1: %s\n",rcv.mtext);
printf("Enter message for TTY-1::");
scanf("%[^\n]s",send.mtext);
send.mtype=2;
len=strlen(send.mtext);
if(msgsnd(qid,&send,len,0)==-1){
	perror("Message Failed");
	exit(0);
}	
}
    </pre>
  
    <h1>TCP message passing server</h1>
    <pre>
includestdio.h
includeunistd.h
includestring.h
includestdlib.h
includesys/socket.h
includearpa/inet.h

int main(){
	int serv_sockfd, cli_sockfd;
	int serv_len, cli_len;
	struct sockaddr_in serv_address, cli_addr;
	char a[100], b[100];

	serv_sockfd = socket(AF_INET, SOCK_STREAM, 0);
	if (serv_sockfd < 0) {
		perror("Socket creation failed");
		exit(1);
	}

	memset(&serv_address, 0, sizeof(serv_address));
	serv_address.sin_family = AF_INET;
	serv_address.sin_port = htons(9001);
	serv_address.sin_addr.s_addr = inet_addr("127.0.0.1");

	serv_len = sizeof(serv_address);
	if (bind(serv_sockfd, (struct sockaddr*)&serv_address, serv_len) < 0) {
		perror("Bind failed");
		exit(1);
	}

	listen(serv_sockfd, 5);

	while(1){
		printf("Server is waiting...\n");
		cli_len = sizeof(cli_addr);
		cli_sockfd = accept(serv_sockfd, (struct sockaddr*)&cli_addr, &cli_len);
		if (cli_sockfd < 0) {
			perror("Accept failed");
			continue;
		}

		read(cli_sockfd, a, sizeof(a));
		printf("Reading message from client: ");
		puts(a);

		printf("Enter message for client: ");
		fgets(b, sizeof(b), stdin);
		write(cli_sockfd, b, strlen(b));  // +1 to include null terminator

		close(cli_sockfd);
	}
}

    </pre>

    <h1>TCP message passing client</h1>
    <pre>
includestdio.h
includeunistd.h
includestdlib.h
includestring.h
includesys/socket.h
includearpa/inet.h

int main(){
	int sockfd, len, result;
	struct sockaddr_in address;
	char name[100], scr[100];

	sockfd = socket(AF_INET, SOCK_STREAM, 0);
	if (sockfd < 0) {
		perror("Socket creation failed");
		exit(1);
	}

	memset(&address, 0, sizeof(address));
	address.sin_family = AF_INET;
	address.sin_port = htons(9001);
	address.sin_addr.s_addr = inet_addr("127.0.0.1");

	len = sizeof(address);
	result = connect(sockfd, (struct sockaddr*)&address, len);
	if(result == -1){
		perror("Unable to connect");
		exit(1);
	}

	printf("\nEnter message: ");
	fgets(name, sizeof(name), stdin);
	write(sockfd, name, strlen(name) + 1);  // +1 to include null terminator

	printf("\nMessage from server: ");
	read(sockfd, scr, sizeof(scr));
	puts(scr);

	close(sockfd);
	return 0;
}

    </pre>

    <h1>IPC client</h1>
    <pre>

    </pre>

</body>
</html>
